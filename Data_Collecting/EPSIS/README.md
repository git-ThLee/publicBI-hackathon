# EPSIS 전력통계시스템 크롤링하는 코드 및 merge하는 코드

|py명|용도|
|:---:|:---|
|epsis.py|EPSIS 크롤링하는 코드|
|validation.py|크롤링한 데이터 검토하는 코드|
|merge.py|1. 크롤링한 데이터 merge하는 코드  \n2. merge한 데이터와 기존 데이터 merge하는 코드|

## epsis.py

> 목적 : 데이터 크롤링

"한국전력거래소_5분단위_전력수급현황_20220407.csv" 제공해주는 데이터는 22년 4월 7일까지밖에 없다. 2022-04-08 - 2023-05-31 기간에 대한 데이터를 수집할 필요가 있다. 한 번에 csv파일을 다운로드해주는 서비스가 없어서, 웹 크롤링을 통해 작업을 진행했다.

> 문제점 :
> 1. <div> 태그 안에 데이터가 <span> 안에 들어가 있는데, <span>이 한 페이지에 19개 씩 보여지며, 스크롤바를 이용해 다음 데이터를 불러와야함. 문제는 처음 19개 데이터를 수집하고, 다음 19개를 보기위해 스크롤바를 밑으로 내리면, 새로운 데이터가 새로운 <span>에 생기는 것이 아니라, 기존에 있는 <span>에 데이터라 덮어써짐. 더 큰 문제는 덮어지는 순서가 뒤죽박죽임. 예를 들어, 20번째부터 데이터가 보이기 시작하면, 19번째 span이나 1번째 span에 20번째 데이터가 순서대로 덮어씌어져야 하는데 가끔 24번째 와 25번째가 뒤바뀐 경우가 있음.
> 2. 가끔 데이터 자체가 없는 날이 있다(ex. 2018-05-06)

> 문제 해결 : [문제 해결 방법(노션)](https://ancient-wire-8f9.notion.site/8a6851ce7b834ccbb0b2371aa1b4e721)


## validation.py

> 목적 : 크롤링을 했다고 100% 신뢰할 수 없기에 검토가 필요하다고 느꼈다.

> 검토 방식 
> 1. 데이터 중에 "기준일시" 컬럼은 "yyyy-mm-dd H:M"포맷을 가진다. 그리고 데이터 간에 5분 단위로 이루어져 있다. 
> 2. 5분 단위를 체크해서 없는 데이터를 찾는 방식을 사용했다.(하루 288개)

> 결론 : 누락된 데이터는 한 번을 경우를 제외하고, 누락이 아닌 실제로 데이터가 없는 경우였다. 누락이 한번된 경우는 epsis.py에서 크롤링 과정중에 span태그가 업데이트가 정상적으로 이루어져야 하지만, 업데이트가 이루어지지 않아 스크롤바를 아래로 내려도 업데이트가 이루어지지 않아 수집을 못한 경우이다.

## merge.py

> 목적 :
> 1. 수집한 2022-2023 데이터 merge하기
> 2. 수집한 2022-2023 데이터와 기존 5분단위 데이터 merge하기

> 결론 : 2022-04-08 - 2023-06-11 기간 동안 수집한 데이터 개수는 총 **123559** 개이다.
